"use strict";var e=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function c(e){try{d(o.next(e))}catch(e){i(e)}}function s(e){try{d(o.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}d((o=o.apply(e,t||[])).next())}))};const t=e=>{const t=document.querySelector(`[data-index="${e}"]`);return"o"===t.innerText?"nought":"×"===t.innerText?"cross":"empty"},n=()=>[[t("00"),t("01"),t("02")],[t("10"),t("11"),t("12")],[t("20"),t("21"),t("22")]],o=e=>{document.querySelectorAll(".box").forEach((e=>{e.removeEventListener("click",i)}));const t=document.querySelector("#message"),n=document.querySelector("#additional-info");"draw"===e?(t.innerText="It's a draw",n.innerText="At least I didn't lose"):"nought"===e?t.innerText="Yay I win":(t.innerText="Well done you won!",n.innerText="wait isn't that meant to be impossible")},r=(e=n())=>{for(const t of["nought","cross"])if(e[0][0]===t&&e[0][1]===t&&e[0][2]===t||e[1][0]===t&&e[1][1]===t&&e[1][2]===t||e[2][0]===t&&e[2][1]===t&&e[2][2]===t||e[0][0]===t&&e[1][0]===t&&e[2][0]===t||e[0][1]===t&&e[1][1]===t&&e[2][1]===t||e[0][2]===t&&e[1][2]===t&&e[2][2]===t||e[0][0]===t&&e[1][1]===t&&e[2][2]===t||e[2][0]===t&&e[1][1]===t&&e[0][2]===t)return t;return e.map((e=>e.filter((e=>"empty"===e)).length)).every((e=>0===e))?"draw":null},i=t=>e(void 0,void 0,void 0,(function*(){const e=t.target;e.innerText="×";let c=r();if(c)return void o(c);const s=document.querySelectorAll(".box");for(const e of s)e.removeEventListener("click",i);yield m();const d=document.querySelector("#message"),u=document.querySelector("#additional-info");if(d.innerText="Your go",u.innerText="",c=r(),c)return void o(c);e.removeEventListener("click",i);const l=n();s.forEach((e=>{const t=e.dataset.index;"empty"===l[parseInt(t[0])][parseInt(t[1])]&&e.addEventListener("click",i)}))})),c=e=>new Promise((t=>{setTimeout(t,e)})),s=(e,t)=>{let n=0;return e.forEach((e=>{e===t&&n++})),n>=2},d=(t,o=n())=>e(void 0,void 0,void 0,(function*(){const e="nought"===t?"cross":"nought",n=[[o[0][0],o[0][1],o[0][2],0],[o[1][0],o[1][1],o[1][2],1],[o[2][0],o[2][1],o[2][2],2]];for(const o of n)if(s(o,t)&&!o.includes(e)){const e=o.indexOf("empty");if(-1!==e)return`${o[3]}${e}`}const r=[[o[0][0],o[1][0],o[2][0],0],[o[0][1],o[1][1],o[2][1],1],[o[0][2],o[1][2],o[2][2],2]];for(const n of r)if(s(n,t)&&!n.includes(e)){const e=n.indexOf("empty");if(-1!==e)return`${e}${n[3]}`}const i=[[o[0][0],o[1][1],o[2][2],0],[o[2][0],o[1][1],o[0][2],1]];for(const n of i)if(s(n,t)&&!n.includes(e)){const e=n.indexOf("empty");if(-1!==e)return 0===e?0===n[3]?"00":"20":2===e?0===n[3]?"22":"02":"11"}return null})),u=(t,o=n())=>e(void 0,void 0,void 0,(function*(){const e=yield d(t,o),n="nought"===t?"cross":"nought";return!!e&&(o[parseInt(e[0])][parseInt(e[1])]=n,Boolean(yield d(t,o)))})),l=(t,o=n())=>e(void 0,void 0,void 0,(function*(){if(yield u(t,o)){let e=1;const n="nought"===t?"cross":"nought",r=yield d(t,o);return r?(e++,o[parseInt(r[0])][parseInt(r[1])]=n,e+(yield l(t,o))):1}return 0})),a=e=>{let t,n,o=e.length;for(;0!==o;)t=Math.floor(Math.random()*o),o--,n=e[o],e[o]=e[t],e[t]=n;return e},m=(t=n())=>e(void 0,void 0,void 0,(function*(){var e;const o=document.querySelector("#message"),r=document.querySelector("#additional-info");o.innerText="My go",r.innerText="Actually I already knew where I was going to go as soon as you put your cross wherever but I have a 500ms timeout to make this look more realistic";const s=null!==(e=yield d("nought"))&&void 0!==e?e:yield d("cross");if(s){const e=document.querySelector(`[data-index="${s}"]`);return e.removeEventListener("click",i),yield c(500),void(e.textContent="o")}const m=[];for(const[e,o]of t.entries())for(const[t,r]of o.entries()){if("empty"!==r)continue;const o=n();o[e][t]="nought",(yield u("nought",o))&&m.push({columnNumber:e,boxNumber:t,forkDepth:yield l("nought",o)})}if(m.length>0){const e=m.sort(((e,t)=>e.forkDepth>t.forkDepth?-1:t.forkDepth>e.forkDepth?1:0))[0],t=document.querySelector(`[data-index="${e.columnNumber}${e.boxNumber}"]`);return t.removeEventListener("click",i),yield c(500),void(t.textContent="o")}const y=[];for(const[e,o]of t.entries())for(const[t,r]of o.entries()){if("empty"!==r)continue;const o=n();o[e][t]="nought",(yield u("cross",o))&&y.push({columnNumber:e,boxNumber:t,forkDepth:yield l("cross",o)})}if(y.length>0){const e=y.sort(((e,t)=>e.forkDepth>t.forkDepth?-1:t.forkDepth>e.forkDepth?1:0))[0],t=document.querySelector(`[data-index="${e.columnNumber}${e.boxNumber}"]`);return t.removeEventListener("click",i),yield c(500),void(t.textContent="o")}for(const[e,o]of t.entries())for(const[t,r]of o.entries()){if("empty"!==r)continue;const o=n();o[e][t]="nought";if(yield d("nought",o)){if(0===(yield l("cross",o))){const n=document.querySelector(`[data-index="${e}${t}"]`);return n.removeEventListener("click",i),yield c(500),void(n.textContent="o")}}}if("empty"===t[1][1]){const e=document.querySelector('[data-index="11"]');return e.removeEventListener("click",i),yield c(500),void(e.textContent="o")}if("cross"===t[0][0]&&"empty"===t[2][2]){const e=document.querySelector('[data-index="22"]');return e.removeEventListener("click",i),yield c(500),void(e.textContent="o")}if("cross"===t[2][0]&&"empty"===t[0][2]){const e=document.querySelector('[data-index="02"]');return e.removeEventListener("click",i),yield c(500),void(e.textContent="o")}if("cross"===t[0][2]&&"empty"===t[2][0]){const e=document.querySelector('[data-index="20"]');return e.removeEventListener("click",i),yield c(500),void(e.textContent="o")}if("cross"===t[2][2]&&"empty"===t[0][0]){const e=document.querySelector('[data-index="00"]');return e.removeEventListener("click",i),yield c(500),void(e.textContent="o")}const f=a(["00","20","02","22"]);if("empty"===t[parseInt(f[0][0])][parseInt(f[0][1])]){const e=document.querySelector(`[data-index="${f[0]}"]`);return e.removeEventListener("click",i),yield c(500),void(e.textContent="o")}if("empty"===t[parseInt(f[1][0])][parseInt(f[1][1])]){const e=document.querySelector(`[data-index="${f[1]}"]`);return e.removeEventListener("click",i),yield c(500),void(e.textContent="o")}if("empty"===t[parseInt(f[2][0])][parseInt(f[2][1])]){const e=document.querySelector(`[data-index="${f[2]}"]`);return e.removeEventListener("click",i),yield c(500),void(e.textContent="o")}if("empty"===t[parseInt(f[3][0])][parseInt(f[3][1])]){const e=document.querySelector(`[data-index="${f[3]}"]`);return e.removeEventListener("click",i),yield c(500),void(e.textContent="o")}const v=a(["01","12","21","10"]);if("empty"===t[parseInt(v[0][0])][parseInt(v[0][1])]){const e=document.querySelector(`[data-index="${v[0]}"]`);return e.removeEventListener("click",i),yield c(500),void(e.textContent="o")}if("empty"===t[parseInt(v[1][0])][parseInt(v[1][1])]){const e=document.querySelector(`[data-index="${v[1]}"]`);return e.removeEventListener("click",i),yield c(500),void(e.textContent="o")}if("empty"===t[parseInt(v[2][0])][parseInt(v[2][1])]){const e=document.querySelector(`[data-index="${v[2]}"]`);return e.removeEventListener("click",i),yield c(500),void(e.textContent="o")}if("empty"===t[parseInt(v[3][0])][parseInt(v[3][1])]){const e=document.querySelector(`[data-index="${v[3]}"]`);return e.removeEventListener("click",i),yield c(500),void(e.textContent="o")}}));window.onload=()=>{document.querySelectorAll(".box").forEach((e=>{e.addEventListener("click",i)}))};
//# sourceMappingURL=index.min.js.map